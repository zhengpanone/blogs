========================
30.3 Socket入门之前
========================

TCP协议
============================

.. important:: 端口号只有整数，范围是0到65535 2的16次方

.. important:: - 80端口分配给HTTP服务
               - 21端口分配给FTP服务

.. note:: **netstat -an** 查看端口状态


Socket
===========================

7层网络模型-OSI
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

- 基础层：物理层（Physical）、数据链路层（Datalink）、网络层（Network)
- 传输层（Transport)：TCP-UDP协议层、Socket
- 高级层：会话层（Session)、表示层（Presentation）、应用层（Application)

|image1| |image2|

SOcket基础
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

- 简单来说是IP地址与端口的结合协议（RFC793）
- 一种地址与端口的结合描述协议
- TCP/IP协议的相关API的总称；是网络Api的集合实现
- 涵盖了：Stream Socket/Datagram Socket
- 作用：

 + 在网络传输中用于唯一标示两个端点之间的链接
 + 端点：包括（IP+Port)
 + 4个要素：客户端地址、客户端端口、服务器地址、服务器端口

- TCP

 + TCP是面向连接的通信协议
 + 通过三次握手建立连接，通讯完成时要拆除连接
 + 由于TCP是面向连接的所以只能用于端到端的通讯

- UDP

 + UDP是面向无连接的通讯协议
 + UDP数据包括目的端口号和源端口号信息
 + 由于通讯不需要连接，所以可以实现广播发送，并不局限于端到端

- TCP/IP协议中，两个进程间通信的主要模式为：CS模型
- 主要目的：协同网络中的计算机资源、服务模式、进程间数据共享
- 常见的：FTP、SMTP、HTTP

报文、协议、Mac地址
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

- 报文

 + 报文段是指TCP/IP协议网络传输过程中，起着路由导航作用
 + 用以查询各个网络路由网段、IP地址、交换协议等IP数据包
 + 报文段充当整个TCP/IP协议数据包的导航路由功能
 + 报文在传输过程中会不断地封装成分组、包、帧来传输
 + 封装方式就是添加一些控制信息组成的首部，即报文头

- 传输协议
 + 协议顾名思义，一种规定，约束
 + 约定大于配置，在网络传输中依然适用；网络的传输流程是健壮的稳定的，得益于基础的协议构成
 + 简单来说：A->B的传输数据，B能识别，反之B->A的传输数据A也能识别，这就是协议

- Mac地址

 + Media Access Control或者Medium Access Control
 + 意译为媒体访问控制，或称为物理地址、硬件地址
 + 用来定义网络设备的位置
 + 形如：44-45-53-54-00-00；与身份证类似

IP，端口，远程服务器
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

- 互联网协议地址（英语：Internet Protocol Address，又译为网际协议地址），缩写为IP地址（英语：IPAddress)
- 是分配给网络上使用网际协议（英语：Internet Protocol，IP)的设备的数字标签
- 常见的IP地址分为IPV4与IPv6两大类
- IP地址由32位二进制数组成，常以XXX.XXX.XXX.XXX形式表现，每组XXX代表小于或等于255的10进制数
- 如：208.80.152.2
- 分为A、B、C、D、E五大类，其中E类属于特殊保留地址

- IPV4

 + 总数量：4,294,967,296个（即232）：42亿个；最终于2011年2月3日用尽
 - 如果主机号是全1，那么这个地址为直接广播地址
 * IP地址“255.255.255.255"为受限广播地址

- IPV6

 + 总共有128位长，IPV6地址的表达形式，一般采用32个十六进制数。也可以想象为1632个
 - 由两个逻辑部分组成：一个64位的网络前缀和一个64位的主机地址，主机地址通常根据物理地址自动生成，叫做EUI-64（或者64-位扩展唯一标识）
 * 2001:0db8:85a3:0000:1319:8a2e:0370:7344
 - IPv4转换为IPv6一定可行，IPv6转换为IPv4不一定可行

- 端口

 + 如果把IP地址比作一间房子，端口就是出入这间房子的门或者窗户
 - 在不同门窗户后有不同的人，房子中的用户与外界交流的出口
 * 外界鸽子（信息）飞到不同窗户也就是给不同的人传递信息
 - 0到1023号端口以及1024到49151号端口都是特殊端口

|image3|

socket 是进程间通信的一种方式，

创建一个tcp socket(tcp套接字)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

::

 import socket
 s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
 
创建一个udp socket(udp套接字)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

::

 import socket
 s = socket.socket(socket.AF_INET,socket.SOck_DGRAM)

::

 from socket import *
 udpSocket = socket(AF_INET,SOck_DGRAM)
 udpSocket.sendto(b"haha","192.168.119.115",8080)



.. |image1| image:: ./image/19022501.webp
.. |image2| image:: ./image/19022502.webp
.. |image3| image:: ./image/i9022503.webp
